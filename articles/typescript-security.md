---
title: "CI„Åß„ÇÑ„Çä„Åü„ÅÑÊúÄ‰ΩéÈôê„ÅÆNode„Çª„Ç≠„É•„É™„ÉÜ„Ç£ÂØæÁ≠ñ"
emoji: "üêøÔ∏è"
type: "tech"
topics: [nodejs, security, frontend, typescript, javascript]
publication_name: nislab
published: true
---

# ÁßÅ„Åü„Å°„ÅÆÁ†îÁ©∂ÂÆ§(NISLab)

https://nisk.doshisha.ac.jp/

# „Ç¢„Éâ„Éô„É≥„Éà„Ç´„É¨„É≥„ÉÄ„Éº 5 Êó•ÁõÆ~

https://nislab-advendcallender-2025.vercel.app/

# ËÉåÊôØ

Node.js „Éó„É≠„Ç∏„Çß„ÇØ„ÉàÔºàReact / Next.js / NestJS „Å™„Å©Ôºâ„ÅØ„ÄÅ‰æùÂ≠ò„Éë„ÉÉ„Ç±„Éº„Ç∏„ÅåÂ§ö„ÅèÊõ¥Êñ∞„ÇÇÈ†ªÁπÅ„Å™„Åü„ÇÅ„ÄÅËÑÜÂº±ÊÄß„ÅåÊ∑∑ÂÖ•„Åó„ÇÑ„Åô„ÅÑ„Å®„ÅÑ„ÅÜÂº±ÁÇπ„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ„Åæ„Åü„ÄÅÊúÄËøë„ÅØ„Çµ„Éó„É©„Ç§„ÉÅ„Çß„Éº„É≥ÊîªÊíÉ„ÅåÂ¢ó„Åà„Å¶„Åä„Çä„ÄÅËá™ÂàÜ„ÅÆ„Ç≥„Éº„Éâ‰ª•Â§ñ„ÅÆÈÉ®ÂàÜ„Åã„Çâ„É™„Çπ„ÇØ„ÅåÁô∫Áîü„Åô„Çã„Åì„Å®„ÇÇÁèç„Åó„Åè„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ

„Åì„ÅÜ„Åó„ÅüÂïèÈ°å„Å´Êó©„ÅèÊ∞ó„Å•„Åè„Åü„ÇÅ„Å´„ÅØ„ÄÅÊâãÂãï„ÉÅ„Çß„ÉÉ„ÇØ„Åß„ÅØ„Å™„Åè CI „Å´„Çª„Ç≠„É•„É™„ÉÜ„Ç£Ë®∫Êñ≠„ÇíÁµÑ„ÅøËæº„Åø„ÄÅËá™Âãï„ÅßÊ§úÂá∫„Åô„Çã‰ªïÁµÑ„Åø„ÅåÂøÖË¶Å„Åß„Åô„ÄÇ

Êú¨Ë®ò‰∫ã„Åß„ÅØ„ÄÅNode.js „Éó„É≠„Ç∏„Çß„ÇØ„Éà„Åß ÊúÄ‰ΩéÈôê CI „Å´ÂÖ•„Çå„Å¶„Åä„Åç„Åü„ÅÑ„Çª„Ç≠„É•„É™„ÉÜ„Ç£„ÉÅ„Çß„ÉÉ„ÇØ„Çí„ÄÅÂΩπÂâ≤„Åî„Å®„Å´„Çè„Åã„Çä„ÇÑ„Åô„ÅèÁ¥π‰ªã„Åó„Åæ„Åô„ÄÇ

# „Çª„Ç≠„É•„É™„ÉÜ„Ç£Ë®∫Êñ≠„ÉÑ„Éº„É´„ÅÆÂÖ®‰ΩìÂÉè

„Çª„Ç≠„É•„É™„ÉÜ„Ç£Ë®∫Êñ≠„ÉÑ„Éº„É´„ÅØ„ÄÅÂ§ß„Åç„Åè 3 „Å§„ÅÆ„Ç´„ÉÜ„Ç¥„É™„Å´ÂàÜÈ°û„Åï„Çå„Åæ„Åô„ÄÇ

| „Ç´„ÉÜ„Ç¥„É™                  | ÂØæË±°                            | „ÉÑ„Éº„É´‰æã                     |
| ------------------------- | ------------------------------- | ---------------------------- |
| SCAÔºà‰æùÂ≠ò„Éë„ÉÉ„Ç±„Éº„Ç∏Ë®∫Êñ≠Ôºâ | Node „Éó„É≠„Ç∏„Çß„ÇØ„Éà               | Snyk„ÄÅOSV-Scanner„ÄÅnpm audit |
| SASTÔºàÈùôÁöÑ„Ç≥„Éº„ÉâËß£ÊûêÔºâ    | Node „Éó„É≠„Ç∏„Çß„ÇØ„Éà               | Semgrep                      |
| „Ç∑„Éº„ÇØ„É¨„ÉÉ„ÉàÊ§úÂá∫          | „É™„Éù„Ç∏„Éà„É™ÂÖ®‰ΩìÔºàË®ÄË™ûÈùû‰æùÂ≠òÔºâ    | gitleaks                     |
| docker image „ÅÆË®∫Êñ≠       | Node „ÅÆ„Éó„É≠„Ç∏„Çß„ÇØ„Éà(Dockerfile) | Snyk„ÄÅTrivy                  |

## 1. ‰æùÂ≠ò„Éë„ÉÉ„Ç±„Éº„Ç∏„ÅÆËÑÜÂº±ÊÄßË®∫Êñ≠ÔºàSCAÔºâ

### ÂØæË±°„ÉÑ„Éº„É´ÔºöSnyk„ÄÅOSV-Scanner„ÄÅnpm audit

**SCAÔºàSoftware Composition AnalysisÔºâ** „ÅØ„ÄÅ`package.json` „ÇÑ `package-lock.json` „ÇíËß£Êûê„Åó„ÄÅ‰æùÂ≠ò„Éë„ÉÉ„Ç±„Éº„Ç∏„Å´Êó¢Áü•„ÅÆËÑÜÂº±ÊÄßÔºàCVEÔºâ„Åå„Å™„ÅÑ„Åã„ÉÅ„Çß„ÉÉ„ÇØ„Åó„Åæ„Åô„ÄÇ
CI „Åß„ÅØ OSV-Scanner „Çí„Éô„Éº„Çπ„Å´„Åó„Å¶„ÄÅ„Åï„Çâ„Å´ÂøÖË¶Å„Å™„Çâ Snyk „ÇíË∂≥„Åô„ÄÇnpm audit „ÅØ„É≠„Éº„Ç´„É´„ÅÆËªΩ„ÅÑ„ÉÅ„Çß„ÉÉ„ÇØ or „Çµ„Éñ„Å®„Åó„Å¶ÈÅãÁî®„Åø„Åü„ÅÑÂΩ¢„Åå„ÅÑ„ÅÑ„ÅÆ„Åã„Å™„Å®ÊÄù„ÅÑ„Åæ„Åô„ÄÇ

## 2. ÈùôÁöÑ„Çª„Ç≠„É•„É™„ÉÜ„Ç£„ÉÅ„Çß„ÉÉ„ÇØÔºàSASTÔºâ

### ÂØæË±°„ÉÑ„Éº„É´ÔºöSemgrep

**SASTÔºàStatic Application Security TestingÔºâ** „ÅØ„ÄÅ„ÇΩ„Éº„Çπ„Ç≥„Éº„Éâ„Çí„Éë„Çø„Éº„É≥„Éû„ÉÉ„ÉÅ„Åß„Çπ„Ç≠„É£„É≥„Åó„ÄÅ„Çª„Ç≠„É•„É™„ÉÜ„Ç£„É™„Çπ„ÇØ„ÇíÊ§úÂá∫„Åó„Åæ„Åô„ÄÇ

### Semgrep „ÅåÊ§úÂá∫„Åô„Çã‰∏ª„Å™ËÑÜÂº±ÊÄß

- XSSÔºà„ÇØ„É≠„Çπ„Çµ„Ç§„Éà„Çπ„ÇØ„É™„Éó„ÉÜ„Ç£„É≥„Ç∞Ôºâ„Å´„Å§„Å™„Åå„ÇãÂç±Èô∫„Å™„Ç≥„Éº„Éâ
- SQL „Ç§„É≥„Ç∏„Çß„ÇØ„Ç∑„Éß„É≥„ÅÆÂèØËÉΩÊÄß„Åå„ÅÇ„ÇãÁîü„ÅÆ„ÇØ„Ç®„É™
- ÂÆâÂÖ®„Åß„Å™„ÅÑÈñ¢Êï∞„ÅÆ‰ΩøÁî®Ôºà`eval()` „Å™„Å©Ôºâ
- „Éè„Éº„Éâ„Ç≥„Éº„Éâ„Åï„Çå„ÅüË™çË®ºÊÉÖÂ†±

## 3. „Ç∑„Éº„ÇØ„É¨„ÉÉ„ÉàÊ§úÂá∫

### ÂØæË±°„ÉÑ„Éº„É´Ôºögitleaks

**gitleaks** „ÅØ„ÄÅ„É™„Éù„Ç∏„Éà„É™ÂÖ®‰Ωì„ÇíÂØæË±°„Å´„ÄÅ„Ç∑„Éº„ÇØ„É¨„ÉÉ„ÉàÊÉÖÂ†±„ÅÆÊºèÊ¥©„ÇíÊ§úÂá∫„Åó„Åæ„Åô„ÄÇ

### gitleaks „ÅåÊ§úÂá∫„Åô„ÇãÂØæË±°

- AWS „Ç¢„ÇØ„Çª„Çπ„Ç≠„ÉºÔºà`AKIA...`Ôºâ
- GitHub Personal Access TokenÔºà`ghp_...`Ôºâ
- ÁßòÂØÜÈçµÔºà`-----BEGIN PRIVATE KEY-----`Ôºâ
- API „Ç≠„Éº„ÄÅ„Éë„Çπ„ÉØ„Éº„Éâ„ÄÅ„Éá„Éº„Çø„Éô„Éº„ÇπÊé•Á∂öÊñáÂ≠óÂàó
- `.env` „Éï„Ç°„Ç§„É´„ÅÆË™çË®ºÊÉÖÂ†±
- config „Éï„Ç°„Ç§„É´ÂÜÖ„ÅÆ„Ç∑„Éº„ÇØ„É¨„ÉÉ„Éà
- ÈÅéÂéª„ÅÆ„Ç≥„Éü„ÉÉ„ÉàÂ±•Ê≠¥„Å´Âê´„Åæ„Çå„Çã„Ç∑„Éº„ÇØ„É¨„ÉÉ„Éà

## 4. Docker „Ç§„É°„Éº„Ç∏„ÅÆ„Çª„Ç≠„É•„É™„ÉÜ„Ç£Ë®∫Êñ≠

### ÂØæË±°„ÉÑ„Éº„É´ÔºöSnyk„ÄÅTrivy

Docker „Ç§„É°„Éº„Ç∏„Å´Âê´„Åæ„Çå„Çã‰æùÂ≠ò„Éë„ÉÉ„Ç±„Éº„Ç∏„ÇÑ OS „Éë„ÉÉ„Ç±„Éº„Ç∏„ÅÆËÑÜÂº±ÊÄß„ÇíÊ§úÂá∫„Åó„Åæ„Åô„ÄÇ
ËøëÂπ¥„ÅØ ECSÔºàAWSÔºâ„ÇÑ Cloud Run „Å™„Å©„ÅÆ„Ç≥„É≥„ÉÜ„ÉäÂÆüË°åÂü∫Áõ§„ÅÆÂà©Áî®„Åå‰∏ÄËà¨Âåñ „Åó„Å¶„Åä„Çä„ÄÅ
„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„Çí„Ç≥„É≥„ÉÜ„Éä„Å®„Åó„Å¶Êú¨Áï™Áí∞Â¢É„Å´„Éá„Éó„É≠„Ç§„Åô„Çã„Ç±„Éº„Çπ„ÅåÂ¢ó„Åà„Å¶„ÅÑ„Åæ„Åô„ÄÇ
„Åù„ÅÆ„Åü„ÇÅ„ÄÅ„Éá„Éó„É≠„Ç§Ââç„Å´„Ç§„É°„Éº„Ç∏Ëá™‰Ωì„Çí„Çπ„Ç≠„É£„É≥„Åó„Å¶ÂÆâÂÖ®ÊÄß„ÇíÁ¢∫Ë™ç„Åô„Çã„Åì„Å®„ÅåÂ§ß‰∫ã„Å´„Å™„Çä„Åæ„Åô„ÄÇ
Snyk „ÇÑ Trivy „Çí CI „Å´ÁµÑ„ÅøËæº„ÇÄ„Åì„Å®„Åß„ÄÅ
Êú¨Áï™Áí∞Â¢É„Å∏ËÑÜÂº±„Å™„Ç≥„É≥„ÉÜ„Éä„Åå„Éá„Éó„É≠„Ç§„Åï„Çå„Çã„É™„Çπ„ÇØ„Çí‰∫ãÂâç„Å´Èò≤„Åê„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„ÄÇ

## ÂèÇËÄÉ

Ëá™ÂàÜ„Åå‰Ωø„Å£„Å¶„ÅÑ„Çã github action „ÅÆ‰æã„Çí‰∏ÄÈÉ®Ëºâ„Åõ„Åï„Åõ„Å¶„ÅÑ„Åü„Å†„Åç„Åæ„Åô.

```bash
name: Security CI

on:
  pull_request:
    branches:
      - main

permissions:
  contents: read
  pull-requests: read
  security-events: write
  actions: read
env:
  NODE_VERSION: "20"
  SNYK_TOKEN: ${{ secrets.SNYK_TOKEN }}
  GITLEAKS_LICENSE: ${{ secrets.GITLEAKS_LICENSE }}

jobs:
  deps_audit: # ‚Üê job_id „ÅØËã±Â≠ó„ÅßÈñãÂßã„ÉªËã±Êï∞/ _ / - „ÅÆ„Åø
    name: Dependencies (npm audit / OSV)
    runs-on: ubuntu-latest # ‚Üê „Åì„Çå„ÅåÂøÖÈ†à
    steps:
      - uses: actions/checkout@v4

      - uses: actions/setup-node@v4
        with:
          node-version: "20"
          cache: "npm"

      - name: Install
        run: npm ci

      - name: npm audit (fail on high)
        run: npm audit --audit-level=high

      - name: OSV-Scanner
        uses: google/osv-scanner-action/osv-scanner-action@v2.2.3
        with:
          scan-args: |-
            -r
            .
      - name: Snyk Open Source scan (optional)
        if: ${{ env.SNYK_TOKEN != '' }}
        uses: snyk/actions/node@master
        env:
          SNYK_TOKEN: ${{ env.SNYK_TOKEN }}
        with:
          args: --severity-threshold=high --file=package.json

  semgrep:
    name: Semgrep (AppSec static analysis)
    runs-on: ubuntu-latest # ‚Üê ÂøÖÈ†à
    steps:
      - uses: actions/checkout@v4
      - uses: returntocorp/semgrep-action@v1
        with:
          generateSarif: true
          config: >
            p/owasp-top-ten
            p/javascript
            p/ci
      - name: Upload SARIF to code scanning
        if: always()
        uses: github/codeql-action/upload-sarif@v3
        with:
          sarif_file: semgrep.sarif
        continue-on-error: true
  gitleaks:
    name: Secret leaks (Gitleaks)
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0
      - uses: gitleaks/gitleaks-action@v2
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          GITLEAKS_LICENSE: ${{ env.GITLEAKS_LICENSE }}
          GITLEAKS_REPORT_PATH: gitleaks.sarif
          GITLEAKS_FORMAT: sarif
          GITLEAKS_FAIL: true
      - name: Upload SARIF
        if: always()
        uses: github/codeql-action/upload-sarif@v3
        with:
          sarif_file: gitleaks.sarif
        continue-on-error: true

  trivy:
    name: Trivy (fs + image)
    runs-on: ubuntu-latest # ‚Üê ÂøÖÈ†à
    steps:
      - uses: actions/checkout@v4

      - name: Trivy FS scan (High‰ª•‰∏ä„Åßfail)
        uses: aquasecurity/trivy-action@0.24.0
        with:
          scan-type: "fs"
          scan-ref: "."
          format: "table"
          exit-code: "1"
          severity: "HIGH,CRITICAL"
          ignore-unfixed: true

      - name: Build backend image
        if: startsWith(github.ref, 'refs/tags/') || endsWith(github.ref, '/release')
        run: dock

```
